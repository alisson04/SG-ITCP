<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"  
      xmlns:componentesGenericos="http://xmlns.jcp.org/jsf/composite/componentesGenericos">

    <ui:composition template="/templates/modeloGeral.xhtml">
        <ui:define name="conteudo">
            <style type="text/css">
                .AlturaLinhas {
                    width: 700px;
                }
            </style>

            <h:form id="frmrelatorios" >
                <!--Painel que guarda as entradas de imagens em base64 vinculadas a view: RelatorioNotaMatuHorasTrabView-->
                <p:panel id="panelIn" visible="false" >
                    <p:dataGrid id="gridIn" var="imagemEmBase64" value="#{RelatorioNotaMatuHorasTrabView.listaImagensBase64}" 
                                layout="grid" rowIndexVar="cont" columns="6" 
                                emptyMessage="Nenhum empreendimento tem lançamentos de horas ou notas" >
                        <p:inputText id="in" value="#{RelatorioNotaMatuHorasTrabView.listaImagensBase64[cont]}" />
                    </p:dataGrid>
                </p:panel>
                
                <!--Painel que guarda as entradas de imagens em base64 vinculadas a view: RelatorioIndicadoresMaturidadeView-->
                <p:panel id="panelInIndicadoresMaturidade" visible="false" >
                    <p:dataGrid id="gridInIndicadoresMaturidade" var="imagemEmBase64" value="#{RelatorioIndicadoresMaturidadeView.listaImagensBase64}" 
                                layout="grid" rowIndexVar="cont" columns="6" 
                                emptyMessage="Nenhum empreendimento tem lançamentos de horas ou notas" >
                        <p:inputText id="in" value="#{RelatorioIndicadoresMaturidadeView.listaImagensBase64[cont]}" />
                    </p:dataGrid>
                </p:panel>

                <!-- Tabelas que separam os tipos de relatórios-->
                <p:tabView id="tbGeral" dynamic="true" cache="true">
                    <p:ajax event="tabChange" listener="#{RelatoriosView.InicializaVariaveis()}" />
                    <p:ajax event="tabChange" listener="#{RelatorioNotaMatuHorasTrabView.onTabChange}" />

                    <!--RELATORIO DOS INDICADORES DE MATURIDADE-->
                    <p:tab id="tabIndis" title="Indicadores de maturidade" >
                        <p:layout style="max-height:700px;" >
                            <p:layoutUnit position="west" size="325" ><!--Lado esquerdo-->
                                <p:panel toggleable="true" styleClass="painelBordas" >
                                    <p:outputPanel style="text-align:center;">
                                        <p:outputLabel value="Empreendimento:" />
                                        <p:selectOneMenu value="#{RelatorioIndicadoresMaturidadeView.empreendimentoSelecionado}" 
                                                         converter="generic" autoWidth="false" style="width: 200px" >
                                            <f:selectItem itemLabel="Clique para selecionar" itemValue="#{null}" />
                                            <p:ajax update="frmrelatorios" event="change"  
                                                    listener="#{RelatorioIndicadoresMaturidadeView.selecionaEptTela()}"/>
                                            <f:selectItems value="#{RelatorioIndicadoresMaturidadeView.listaEmpreendimentos}" var="ept" 
                                                           itemLabel="#{ept.sigla}" itemValue="#{ept}"/>
                                        </p:selectOneMenu>
                                    </p:outputPanel>
                                </p:panel>
                                <p:spacer height="10px"/>

                                <p:panel rendered="#{RelatorioIndicadoresMaturidadeView.empreendimentoSelecionado != null}" 
                                         toggleable="true" >
                                    <p:outputPanel style="text-align:center;">
                                        <p:outputLabel value="Categoria:" />

                                        <p:selectOneMenu value="#{RelatorioIndicadoresMaturidadeView.categoriaSelecionada}"
                                                         autoWidth="false" style="width: 200px" >
                                            <p:ajax update="frmrelatorios" event="change"
                                                    listener="#{RelatorioIndicadoresMaturidadeView.selecionaCategoriaTela()}" />

                                            <f:selectItem itemLabel="Clique para selecionar" itemValue="" />

                                            <f:selectItem itemLabel="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[0].categoria}" 
                                                          itemValue="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[0].categoria}"  />

                                            <f:selectItem itemLabel="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[6].categoria}" 
                                                          itemValue="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[6].categoria}"  />

                                            <f:selectItem itemLabel="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[10].categoria}" 
                                                          itemValue="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[10].categoria}"  />

                                            <f:selectItem itemLabel="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[16].categoria}" 
                                                          itemValue="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[16].categoria}"  />

                                            <f:selectItem itemLabel="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[24].categoria}" 
                                                          itemValue="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[24].categoria}"  />

                                            <f:selectItem itemLabel="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[31].categoria}" 
                                                          itemValue="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[31].categoria}"  />

                                            <f:selectItem itemLabel="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[36].categoria}" 
                                                          itemValue="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[36].categoria}"  />

                                            <f:selectItem itemLabel="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[42].categoria}" 
                                                          itemValue="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[42].categoria}"  />

                                            <f:selectItem itemLabel="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[46].categoria}" 
                                                          itemValue="#{RelatorioIndicadoresMaturidadeView.listaIndicadores[46].categoria}"  />
                                        </p:selectOneMenu>
                                    </p:outputPanel>
                                </p:panel>
                                <p:spacer height="10px"/>

                                <p:panel rendered="#{RelatorioIndicadoresMaturidadeView.categoriaSelecionada != ''}" >
                                    <p:outputPanel style="text-align:center;">
                                        <!--Esta centralizado por não ficar coerente com os outros se ficar a direita-->
                                        <p:outputLabel value="Indicadores:" />
                                        <p:separator />
                                        <p:selectBooleanCheckbox value="#{RelatorioIndicadoresMaturidadeView.selecionaTodosInds}" >
                                            <p:ajax update="frmrelatorios" 
                                                    onsuccess="#{RelatorioIndicadoresMaturidadeView.geraImagemBase64()}"
                                                    listener="#{RelatorioIndicadoresMaturidadeView.selecionaTodosIndsView()}" />
                                        </p:selectBooleanCheckbox>
                                        <h:outputText value=" Todos" />
                                    </p:outputPanel>

                                    <p:selectManyCheckbox value="#{RelatorioIndicadoresMaturidadeView.listaIndsSelecionados}" 
                                                          layout="grid" converter="generic" columns="1" >
                                        <p:ajax listener="#{RelatorioIndicadoresMaturidadeView.criaGraficoInd()}" 
                                                update="frmrelatorios"
                                                onsuccess="#{RelatorioIndicadoresMaturidadeView.geraImagemBase64()}"
                                                onstart="PF('blockUiGeral').show()" oncomplete="PF('blockUiGeral').hide()"/>
                                        <f:selectItems value="#{RelatorioIndicadoresMaturidadeView.listaTodosInds}" 
                                                       var="ind" itemLabel="#{ind.nome}" itemValue="#{ind}" />
                                    </p:selectManyCheckbox>
                                </p:panel>

                                <p:spacer height="20px" />

                                <p:panel rendered="#{RelatorioIndicadoresMaturidadeView.categoriaSelecionada != ''}" >
                                    <p:outputPanel style="text-align:center;">
                                        <p:graphicImage width="128px" height="128px" name="/icons128/128Relatorio.png" />
                                        <p:remoteCommand name="rc" update=":frmrelatorios:panelInIndicadoresMaturidade" 
                                                         oncomplete="PF('dlWidGetVarReportIndicadores').show()" />
                                        <p:commandButton value="Gerar Relatório" immediate="true"                                               
                                                         onsuccess="rc()"  />                                        
                                    </p:outputPanel>
                                </p:panel>
                            </p:layoutUnit>

                            <p:layoutUnit position="center" >
                                <!-- Decidiu-se retirar a tabela abaixo
                                <p:fieldset legend="Notas de maturidade" toggleable="true" toggleSpeed="500">
                                    <p:dataTable emptyMessage="Nenhuma nota cadastrada." 
                                                 value="#{RelatorioIndicadoresMaturidadeView.listaNotas}" 
                                                 var="cursor" widgetVar="varGlobal" rows="10" paginator="true" style="text-align: center"
                                                 rowKey="#{cursor.id}" paginatorPosition="top">

                                        <p:column headerText="Empreendimento" >
                                            <h:outputText value="#{cursor.empreendimento.sigla}"/>
                                        </p:column>

                                        <p:column headerText="Nota atual" >
                                            <h:outputText value="#{cursor.nota}"/>
                                        </p:column>

                                        <p:column headerText="Nota máxima" >
                                            <h:outputText value="#{cursor.notaMaxima}"/>
                                        </p:column>

                                        <p:column headerText="Porcentagem" >
                                            <h:outputText value="#{modeloGeralView.geraPorcentagem(cursor.nota, cursor.notaMaxima)} %"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:fieldset>
                                <p:spacer height="20px" />-->

                                <p:fieldset legend="Evolução dos indicadores" toggleable="true" toggleSpeed="500"
                                            rendered="#{RelatorioIndicadoresMaturidadeView.listaGraficoInds.size() > 0}" >
                                    <p:dataGrid var="graInd" value="#{RelatorioIndicadoresMaturidadeView.listaGraficoInds}" 
                                                layout="grid" columns="1" rowIndexVar="contador" >
                                        <p:panel >
                                            <p:chart type="line" model="#{graInd}" 
                                                     widgetVar="#{RelatorioIndicadoresMaturidadeView.listaWidgetVars[contador]}" />
                                        </p:panel>
                                    </p:dataGrid>
                                </p:fieldset>
                            </p:layoutUnit>
                        </p:layout>
                    </p:tab>

                    <!--ABA RELATÓRIO DE ATIVIDADES POR EMPREENDIMENTO-->
                    <p:tab id="tabTeste" title="Atividades por empreendimento">
                        <p:layout style="min-height:700px;max-height:700px;" >
                            <p:layoutUnit position="west" size="325" >
                                <p:outputPanel style="text-align:center;" >
                                    <p:outputLabel value="Filtrar por: " />
                                </p:outputPanel>
                                <p:spacer height="10px"/>

                                <p:panel header="Empreendimentos" toggleable="true" styleClass="painelBordas" >
                                    <p:selectOneRadio value="#{RelatoriosView.empreendimentoSelecionado}" 
                                                      converter="generic" layout="grid" columns="1" >
                                        <p:ajax update="frmrelatorios" event="change"  
                                                listener="#{RelatoriosView.filtraAtividadesPorEes()}"/>
                                        <f:selectItems value="#{RelatoriosView.listaEmpreendimentos}" var="ept" 
                                                       itemLabel="#{ept.nome}" itemValue="#{ept}"/>
                                    </p:selectOneRadio>
                                </p:panel>
                                <p:spacer height="10px"/>

                                <p:panel header="Plano de ação" rendered="#{RelatoriosView.empreendimentoSelecionado != null}">
                                    <p:selectOneRadio value="#{RelatoriosView.planoSelecionado}" 
                                                      converter="generic" layout="grid" columns="1" >
                                        <p:ajax update="frmrelatorios" event="change"  
                                                listener="#{RelatoriosView.filtraAtividadesPorPlano()}" />
                                        <f:selectItems value="#{RelatoriosView.listaPlanos}" var="plano" itemLabel="#{plano.nome} 
                                                       / Início em: #{modeloGeralView.converteData(plano.dataInicio)}" itemValue="#{plano}"/>
                                    </p:selectOneRadio>
                                </p:panel>
                            </p:layoutUnit>

                            <p:layoutUnit position="center" >
                                <p:dataTable id="dtListagemAtividades" emptyMessage="Nenhuma atividade cadastrada " 
                                             value="#{RelatoriosView.listaAtividades}" style="text-align: center"
                                             filteredValue="#{RelatoriosView.listaAtividadesFiltradas}" rowKey="#{objCursor.id}"
                                             var="objCursor" widgetVar="varGlobal" rows="12" paginator="true" paginatorPosition="top">

                                    <p:column headerText="Nome" filterBy="#{objCursor.nome}" sortBy="#{objCursor.nome}" 
                                              filterMatchMode="contains" >
                                        <h:outputText value="#{objCursor.nome}"/>
                                    </p:column>

                                    <p:column headerText="Data início" styleClass="colunasTabela100PX" >
                                        <h:outputText value="#{modeloGeralView.converteData(objCursor.dataInicio)}" />
                                    </p:column>

                                    <p:column headerText="Data fim" styleClass="colunasTabela100PX" >
                                        <h:outputText value="#{modeloGeralView.converteData(objCursor.dataFim)}" />
                                    </p:column>

                                    <p:column headerText="Situação"  filterBy="#{objCursor.status}" filterMatchMode="exact" 
                                              styleClass="colunasTabela200PX" >
                                        <f:facet name="filter">
                                            <p:selectOneMenu onchange="PF('varGlobal').filter()" >
                                                <f:selectItem itemLabel="Não filtrar" itemValue="#{null}" noSelectionOption="true" />
                                                <f:selectItem itemLabel="Não iniciada" itemValue="Não iniciada" />
                                                <f:selectItem itemLabel="Iniciada" itemValue="Iniciada" />
                                                <f:selectItem itemLabel="Finalizada" itemValue="Finalizada" />
                                            </p:selectOneMenu>
                                        </f:facet>

                                        <p:graphicImage width="32px" height="32px" styleClass="semMargin" name="/icons32/32FlagRed.png"
                                                        rendered="#{objCursor.status == 'Não iniciada'}" />
                                        <p:graphicImage width="32px" height="32px" styleClass="semMargin" name="/icons32/32FlagYellow.png"
                                                        rendered="#{objCursor.status == 'Iniciada'}" />
                                        <p:graphicImage width="32px" height="32px" styleClass="semMargin" name="/icons32/32FlagGreen.png"
                                                        rendered="#{objCursor.status == 'Finalizada'}" />
                                    </p:column>

                                    <p:column filterBy="#{objCursor.meta}" headerText="Meta" filterMatchMode="exact">
                                        <f:facet name="filter">
                                            <p:selectOneMenu onchange="PF('varGlobal').filter()" >
                                                <f:selectItem itemLabel="Não filtrar" itemValue="#{null}" noSelectionOption="true" />
                                                <f:selectItems value="#{ListarAtiviPlanejadasView.listaMetas}" var="var"
                                                               itemLabel="#{var.nome}" itemValue="#{var}"/>
                                            </p:selectOneMenu>
                                        </f:facet>
                                        <h:outputText value="#{objCursor.meta.nome}" />
                                    </p:column>

                                    <f:facet name="footer">
                                        <h:commandLink id="pdfUsr">
                                            <p:graphicImage name="icons24/Pdf24.png" width="24"/>
                                            <p:dataExporter type="pdf" target="dtListagemAtividades" fileName="Metas" encoding="ISO-8859-1" />
                                        </h:commandLink> 

                                        <p:spacer height="20px"/>

                                        <h:commandLink id="xlsUsr">
                                            <p:graphicImage name="icons24/Xls24.png" width="24"/>
                                            <p:dataExporter type="xls" target="dtListagemAtividades" fileName="Metas" />
                                        </h:commandLink>

                                        <p:tooltip for="pdfUsr" value="Exportar para PDF" />
                                        <p:tooltip for="xlsUsr" value="Exportar para Excel" />
                                    </f:facet>
                                </p:dataTable>
                            </p:layoutUnit>
                        </p:layout>
                    </p:tab>

                    <p:tab id="tabAtividadesPorUser" title="Atividades por usuário">
                        <p:layout style="min-height:700px;max-height:700px;" >
                            <p:layoutUnit position="west" size="325" >
                                <p:outputPanel style="text-align:center;" >
                                    <p:outputLabel value="Filtrar por: " />
                                </p:outputPanel>
                                <p:spacer height="10px"/>

                                <p:panel header="Usuários" >
                                    <p:selectOneRadio value="#{RelatoriosView.userSelecionado}" 
                                                      converter="generic" layout="grid" columns="1" >
                                        <p:ajax update="frmrelatorios" event="change"  
                                                listener="#{RelatoriosView.filtraAtividadesPorUser()}"/>
                                        <f:selectItems value="#{RelatoriosView.listaUser}" var="var" 
                                                       itemLabel="#{var.nome}" itemValue="#{var}"/>
                                    </p:selectOneRadio>
                                </p:panel>
                            </p:layoutUnit>

                            <p:layoutUnit position="center" >
                                <p:dataTable emptyMessage="Nenhuma atividade cadastrada " 
                                             value="#{RelatoriosView.listaAtividades}" style="text-align: center"
                                             filteredValue="#{RelatoriosView.listaAtividadesFiltradas}" rowKey="#{objCursor.id}"
                                             var="objCursor" widgetVar="varGlobal" rows="12" paginator="true" paginatorPosition="top">

                                    <p:column headerText="Nome" filterBy="#{objCursor.nome}" sortBy="#{objCursor.nome}" 
                                              filterMatchMode="contains" >
                                        <h:outputText value="#{objCursor.nome}"/>
                                    </p:column>

                                    <p:column headerText="Data início" styleClass="colunasTabela100PX" >
                                        <h:outputText value="#{modeloGeralView.converteData(objCursor.dataInicio)}" />
                                    </p:column>

                                    <p:column headerText="Data fim" styleClass="colunasTabela100PX" >
                                        <h:outputText value="#{modeloGeralView.converteData(objCursor.dataFim)}" />
                                    </p:column>

                                    <p:column headerText="Situação"  filterBy="#{objCursor.status}" filterMatchMode="exact" 
                                              styleClass="colunasTabela200PX" >
                                        <f:facet name="filter">
                                            <p:selectOneMenu onchange="PF('varGlobal').filter()" >
                                                <f:selectItem itemLabel="Não filtrar" itemValue="#{null}" noSelectionOption="true" />
                                                <f:selectItem itemLabel="Não iniciada" itemValue="Não iniciada" />
                                                <f:selectItem itemLabel="Iniciada" itemValue="Iniciada" />
                                                <f:selectItem itemLabel="Finalizada" itemValue="Finalizada" />
                                            </p:selectOneMenu>
                                        </f:facet>

                                        <p:graphicImage width="32px" height="32px" styleClass="semMargin" name="/icons32/32FlagRed.png"
                                                        rendered="#{objCursor.status == 'Não iniciada'}" />
                                        <p:graphicImage width="32px" height="32px" styleClass="semMargin" name="/icons32/32FlagYellow.png"
                                                        rendered="#{objCursor.status == 'Iniciada'}" />
                                        <p:graphicImage width="32px" height="32px" styleClass="semMargin" name="/icons32/32FlagGreen.png"
                                                        rendered="#{objCursor.status == 'Finalizada'}" />
                                    </p:column>

                                    <p:column filterBy="#{objCursor.meta}" headerText="Meta" filterMatchMode="exact">
                                        <f:facet name="filter">
                                            <p:selectOneMenu onchange="PF('varGlobal').filter()" >
                                                <f:selectItem itemLabel="Não filtrar" itemValue="#{null}" noSelectionOption="true" />
                                                <f:selectItems value="#{ListarAtiviPlanejadasView.listaMetas}" var="var"
                                                               itemLabel="#{var.nome}" itemValue="#{var}"/>
                                            </p:selectOneMenu>
                                        </f:facet>
                                        <h:outputText value="#{objCursor.meta.nome}" />
                                    </p:column>

                                    <f:facet name="footer">
                                        <h:commandLink id="pdfUsr">
                                            <p:graphicImage name="icons24/Pdf24.png" width="24"/>
                                            <p:dataExporter type="pdf" target="dtListagemAtividades" fileName="Metas" encoding="ISO-8859-1" />
                                        </h:commandLink> 

                                        <p:spacer height="20px"/>

                                        <h:commandLink id="xlsUsr">
                                            <p:graphicImage name="icons24/Xls24.png" width="24"/>
                                            <p:dataExporter type="xls" target="dtListagemAtividades" fileName="Metas" />
                                        </h:commandLink>

                                        <p:tooltip for="pdfUsr" value="Exportar para PDF" />
                                        <p:tooltip for="xlsUsr" value="Exportar para Excel" />
                                    </f:facet>
                                </p:dataTable>
                            </p:layoutUnit>
                        </p:layout>
                    </p:tab>

                    <p:tab id="tabExecucaoPlano" title="Execução do plano de ação">
                        <p:layout style="min-height:700px;max-height:700px;" >
                            <p:layoutUnit position="west" size="325" >
                                <p:panel header="Empreendimentos" >
                                    <p:selectOneRadio value="#{RelatoriosView.empreendimentoSelecionado}" 
                                                      converter="generic" layout="grid" columns="1" >
                                        <p:ajax update="frmrelatorios" event="change"  
                                                listener="#{RelatoriosView.selecionaEes()}"/>
                                        <f:selectItems value="#{RelatoriosView.listaEmpreendimentos}" var="var" 
                                                       itemLabel="#{var.nome}" itemValue="#{var}"/>
                                    </p:selectOneRadio>
                                </p:panel>
                                <p:spacer height="10px" />

                                <p:panel header="Planos de ação" rendered="#{RelatoriosView.empreendimentoSelecionado != null}" >
                                    <p:outputPanel style="text-align:center;" rendered="#{RelatoriosView.listaPlanos.size() == 0}" >
                                        <p:outputLabel value="Não há planos de ação cadastrados para esse empreendimento!" />
                                        <p:separator/>
                                    </p:outputPanel>
                                    <p:selectOneRadio value="#{RelatoriosView.planoSelecionado}" 
                                                      converter="generic" layout="grid" columns="1" >
                                        <p:ajax update="frmrelatorios" event="change"  
                                                listener="#{RelatoriosView.criaGraficoPieChatAtiviMetas()}"/>
                                        <f:selectItems value="#{RelatoriosView.listaPlanos}" var="var" 
                                                       itemLabel="#{var.nome}" itemValue="#{var}"/>
                                    </p:selectOneRadio>
                                </p:panel>
                            </p:layoutUnit>

                            <p:layoutUnit position="center" >
                                <p:panelGrid columns="2" layout="grid">
                                    <p:panel rendered="#{RelatoriosView.planoSelecionado != null 
                                                         and RelatoriosView.empreendimentoSelecionado != null 
                                                         and RelatoriosView.graficoAtividadesPlano != null}" >
                                        <p:chart type="pie" model="#{RelatoriosView.graficoAtividadesPlano}" 
                                                 style="width:400px;height:300px" />                            
                                    </p:panel>

                                    <p:panel rendered="#{RelatoriosView.planoSelecionado != null 
                                                         and RelatoriosView.empreendimentoSelecionado != null 
                                                         and RelatoriosView.graficoMetasPlano != null}" >
                                        <p:chart type="pie" model="#{RelatoriosView.graficoMetasPlano}" 
                                                 style="width:400px;height:300px" />
                                    </p:panel>
                                </p:panelGrid>
                            </p:layoutUnit>
                        </p:layout>
                    </p:tab>

                    <p:tab id="tabDivisaoForcaTrabalho" title="Nota de maturidade e Horas trabalhadas" >
                        <p:layout style="min-height:700px;max-height:700px;" >  
                            <p:layoutUnit position="west" size="250" >
                                <p:panel >
                                    <p:outputPanel style="text-align:center;" >
                                        <p:outputLabel value="Filtro de Informações da força de trabalho" />
                                        <p:separator/>

                                        <h:panelGrid columns="2">                                        
                                            <p:outputLabel value="De " />
                                            <p:calendar value="#{RelatorioNotaMatuHorasTrabView.dataFiltroInicio}" locale="pt" 
                                                        navigator="true" pattern="dd/MM/yyyy" size="10" mask="true" >
                                                <p:ajax event="dateSelect" onstart="PF('blockUiGeral').show()" 
                                                        oncomplete="PF('blockUiGeral').hide()" update="frmrelatorios"
                                                        onsuccess="#{RelatorioNotaMatuHorasTrabView.geraImagemBase64()}"
                                                        listener="#{RelatorioNotaMatuHorasTrabView.modificaDataTela}" />
                                            </p:calendar>

                                            <p:outputLabel value="até " />
                                            <p:calendar value="#{RelatorioNotaMatuHorasTrabView.dataFiltroFim}" locale="pt" 
                                                        navigator="true" pattern="dd/MM/yyyy" size="10" mask="true" >
                                                <p:ajax event="dateSelect"  onstart="PF('blockUiGeral').show()" 
                                                        oncomplete="PF('blockUiGeral').hide()" update="frmrelatorios"
                                                        onsuccess="#{RelatorioNotaMatuHorasTrabView.geraImagemBase64()}"
                                                        listener="#{RelatorioNotaMatuHorasTrabView.modificaDataTela}" />
                                            </p:calendar>                               
                                        </h:panelGrid>
                                    </p:outputPanel>  
                                </p:panel>

                                <p:spacer height="20px" />

                                <p:panel >
                                    <p:outputPanel style="text-align:center;">
                                        <p:graphicImage width="128px" height="128px" name="/icons128/128Relatorio.png"
                                                        onclick="PF('diaRelatorioWidGetVar').hide()" />
                                        <p:remoteCommand name="rc" update=":frmrelatorios:panelIn" 
                                                         oncomplete="PF('diaRelatorioWidGetVar').show()" />
                                        <p:commandButton value="Gerar Relatório" immediate="true"                                               
                                                         onsuccess="rc()"  />                                        
                                    </p:outputPanel>
                                </p:panel>
                            </p:layoutUnit>

                            <p:layoutUnit position="center" >
                                <p:fieldset legend="Somatório das horas e usuários" toggleable="true" 
                                            toggleSpeed="500" >
                                    <p:dataTable emptyMessage="Nenhuma nota cadastrada." value="#{RelatorioNotaMatuHorasTrabView.listaEes}" 
                                                 var="eesCursor" widgetVar="eesVarGlobal" rows="10" paginator="true" 
                                                 style="text-align: center" rowKey="#{eesCursor.id}" paginatorPosition="top">

                                        <p:column headerText="Empreendimento" >
                                            <h:outputText value="#{eesCursor.sigla}"/>
                                        </p:column>

                                        <p:column headerText="Total de horas em atividades" >
                                            <h:outputText value="#{RelatorioNotaMatuHorasTrabView.geraHorasTrabAtividades(eesCursor)}"/>
                                        </p:column>

                                        <p:column headerText="Quantiade de usuários envolvidos" >
                                            <h:outputText value="#{RelatorioNotaMatuHorasTrabView.geraQuantiUser(eesCursor)}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:fieldset>

                                <p:spacer height="10px" />

                                <p:fieldset legend="Evolução da nota e tempo dedicado" toggleable="true" toggleSpeed="500"
                                            rendered="#{RelatorioNotaMatuHorasTrabView.listaGraficoCombinado.size() != 0}" >

                                    <p:dataGrid var="graNotasHoras" value="#{RelatorioNotaMatuHorasTrabView.listaGraficoCombinado}" 
                                                layout="grid" columns="1" rowIndexVar="contador" 
                                                emptyMessage="Nenhum empreendimento tem lançamentos de horas ou notas" >
                                        <p:panel >
                                            <p:chart type="line" model="#{graNotasHoras}"
                                                     widgetVar="#{RelatorioNotaMatuHorasTrabView.listaWidgetVars[contador]}" />
                                        </p:panel>
                                    </p:dataGrid>
                                </p:fieldset>
                            </p:layoutUnit>
                        </p:layout>
                    </p:tab>

                    <!--<p:tab id="tabExecucaoPlanoAcao" title="Execução dos planos de ação">
                        <p:layout style="min-height:700px;max-height:700px;" >
                            <p:layoutUnit position="west" size="325" >
                                <p:panel >
                                    <p:outputPanel style="text-align:center;">
                                        <p:outputLabel value="Selecione um empreendimento" />
                                    </p:outputPanel>
                                    <p:separator />

                                    <p:selectOneRadio value="#{RelatorioPlanoAcaoView.eesSelecionado}" 
                                                      converter="generic" layout="grid" columns="1" >
                                        <p:ajax update="frmrelatorios" event="change"  
                                                listener="#{RelatorioPlanoAcaoView.selecionaEes()}"/>
                                        <f:selectItems value="#{RelatorioPlanoAcaoView.listaEes}" var="var" 
                                                       itemLabel="#{var.sigla}" itemValue="#{var}"/>
                                    </p:selectOneRadio>
                                </p:panel>
                            </p:layoutUnit>

                            <p:layoutUnit position="center" >
                                <p:dataTable emptyMessage="Nenhuma nota cadastrada." value="#{RelatorioForcaTrabalhoView.listaEes}" 
                                             var="eesCursor" widgetVar="eesVarGlobal" rows="10" paginator="true" 
                                             style="text-align: center" rowKey="#{eesCursor.id}" paginatorPosition="top">

                                </p:dataTable>
                            </p:layoutUnit>
                        </p:layout>
                    </p:tab>-->
                </p:tabView>

                <componentesGenericos:dlTipoRelatorio wvDialogReport="dlWidGetVarReportIndicadores"
                                                      alDownload="#{RelatorioIndicadoresMaturidadeView.gerarRelatorio('attachment')}"
                                                      alEmTela="#{RelatorioIndicadoresMaturidadeView.gerarRelatorio('inline')}" />

                <componentesGenericos:dlTipoRelatorio wvDialogReport="diaRelatorioWidGetVar"
                                                      alDownload="#{RelatorioNotaMatuHorasTrabView.gerarRelatorio('attachment')}"
                                                      alEmTela="#{RelatorioNotaMatuHorasTrabView.gerarRelatorio('inline')}" />
            </h:form>
        </ui:define>
    </ui:composition>
</html>